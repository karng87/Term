# 스트링관련 인스트럭션들, REP 접두어, 방향 플래그(Direction Flag)

### instruction of string
스트링과 배열을 다룰 때 쓰는 인스트럭션들과 이차원 배열을 사용하는 방법,  
문자열 소팅함수를 만드는 방법에 대해 배울 것이다.   
또한 본 회의 내용을 이용하면 스트링과 배열 처리를 고급언어를 이용하는 것 보다 훨씬 빠르게 할 수 있다.  
어셈블리어에서는 스트링을 다루는 데 이용될 수 있는 좀더 편리한 인스트럭션들이 제공되기 때문이다.  
(엄밀히 말하면 CPU가 제공하는 것이다.)  
이차원 배열은 고급언어에서와 달리 사용하기가 간단하지 않다.  
따라서 이를 사용하는 방법을 공부해 볼 것이다.  
마지막으로 직접 버블소팅을 이용한 소팅함수를 만들어 볼 계획이다.

- 스트링관련 인스트럭션들
스트링 처리와 관련된 인스트럭션들은 다섯가지 '군'으로 분류될 수 있다. 
  - MOVS계열, 
  - CMPS계열, 
  - SCAS계열, 
  - STOS계열, 
  - LODS계열.

한가지 알아두어야 할 것은 이들 인스트럭션은 
- ESI나  
- EDI를  
사용한다는 점이다.

< 표 1 : 스트링관련 인스트럭션들>
| instruction | description |
|---|---|
| MOVSB, MOVSW, MOVSD | 한 메모리 주소에서 다른곳으로 값을 복사한다.|
| CMPSB, CMPSW, CMPSD| 메모리에 있는 두 값을 비교한다
| SCASB, SCASW, SCASD	| 정수값과 메모리의 값을 비교한다.|
| STOSB, STOSW, STOSD	| 정수값을 메모리에 복사한다.|
| LODSB, LODSW, LODSD	| 메모리의 값을 AL또는 AX 또는 EAX에 읽어들인다.|

esi에서 
  - s는 source를 뜻하므로 '값을 읽어오는 곳'으로 쓰이고, 
edi에서 
  - d는 destination을 뜻하므로 '값을 쓰는 곳'으로 쓰인다. 
  
주의할 것은 esi와 edi에 주소가 들어있다는 것이다. 
  - esi에서 값을 읽어오는 것이 아니라 esi가 가리키는 곳에서 값을 읽어오고, 
  - edi에 값을 쓰는 것이 아니라 edi가 가리키는 곳에 값을 쓴다는 점이다. 
  - 따라서 인스트럭션을 수행하기 전에 esi와 edi에 스트링 또는 배열의 시작주소를 넣어둬야 한다.

### 방향 플래그(Direction Flag)
스트링 관련 인스트럭션들은 수행 후에  
esi와 edi의 값을 증가시키거나 감소시킨다.   
esi와 edi에는 포인터를 넣어 두어야 한다고 했다.   
따라서 esi와 edi는 바로 다음 것을 가리키게 될 것이다.   
하지만 이것은   
방향플래그가 0(CLD - CLear Direction)일 때 이야기다.   
만약 방향플래그가 1(STD - SeT Direction)일 경우에는 스트링 관련 인스트럭션 수행 후에 esi와 edi의 값이 감소될 것이다.   
(스트링 관련 인스트럭션이   
b로 끝나는 것이면 1바이트 가감,   
w로 끝나는 것이면 2바이트 가감,   
d로 끝나는 것이면 4바이트 가감될 것이다.   
각각은 Byte, Word, Double word를 의미한다.)   
즉, 배열이나 스트링에서 바로 앞을 가리키게 된다. 다음 표에 요약해 놓았다.  

| 방향플래그의 값 | ESI와 EDI | 설정 인스트럭션 | stand for |
|---|---|---|---|
| 0 | 증가 | CLD | CLear Direction |
| 1 | 감소 | STD | SeT Direction |







